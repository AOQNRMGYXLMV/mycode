#include <cstdio>
#include <cstring>
#include <algorithm>
using namespace std;

const int maxn = 30;
const int maxs = 1800;
const int INF = 100000;

int n, m;
int a[maxn][maxn];
int d[maxn][maxn][maxs];

int main()
{
	int T; scanf("%d", &T);
	for(int kase = 1; kase <= T; kase++) {
		scanf("%d%d", &n, &m);
		for(int i = 0; i < n; i++)
			for(int j = 0; j < m; j++) scanf("%d", &a[i][j]);
		d[0][0][a[0][0]] = a[0][0] * a[0][0];
		for(int i = 0; i <= 30; i++) if(i != a[0][0])
			d[0][0][i] = INF;
		for(int i = 0; i < n; i++) {
			for(int j = 0; j < m; j++) if(i + j) {
				for(int k = 0; k <= (i + j) * 30; k++) {
					int v = a[i][j];
					int& ans = d[i][j][v + k];
					ans = INF;
					if(i) ans = min(ans, d[i-1][j][k] + v * v);
					if(j) ans = min(ans, d[i][j-1][k] + v * v);
				}
			}
		}

		int ans = INF * 10000;
		for(int s = 0; s <= 1800; s++)
			ans = min(ans, d[n-1][m-1][s] * (n+m-1) - s*s);
		printf("Case #%d: %d\n", kase, ans);
	}

	return 0;
}
